//--------------------------------------------------------------
// rAthena 數據封包配置文件
// 由 davidsiaw 翻譯成英文
// 由 ａｌｏｎｅ 將本文件翻譯成中文並提交到 rAthenaCN
// 由 Sola、小克 於 2015年8月18日00:20:41 梳理並納入 rAthenaCN 代碼庫
//--------------------------------------------------------------


// 在終端窗口中, 顯示調試報告
// 啟用之後, 每當客戶端建立連接時, 你可以在終端裡面留意到下列提示信息: 
// 「連接檢查: 來自 127.0.0.1 的連接請求已被允許\n」
debug: no

// 若IP地址在「IP規則」中被明確聲明為「允許連接」時,
// 是否不在終端顯示出「已關閉與 'XXXX' 建立的連接.」
//
// 此選項用於當有程序頻繁對服務端的端口建立探測連接,
// (如RO321的服務器存活監測, 或者阿里雲SLB的健康監測等)
// 而導致終端窗口出現大量「已關閉與 'XXXX' 建立的連接.」提示時使用.
// 
// 具體用法:
// 假如阿里雲的SLB會用特定IP範圍的設備不斷探測rAthena端口的健康狀況時
// 只需要在下面的「IP規則」中, 將阿里雲SLB發起探測的IP地址加入白名單
// 然後再將此選項設置為 yes 即可.
allow_silent: yes

// 套接字在被關閉之前, 可以滯留多長時間(單位為秒)
// 在一般情況下, 服務端為了能夠和其他程序或其他電腦通訊, 
// 會專門為了建立請求而創建一種叫套接字的連接接口. 
// 一般來說當連接關閉之後, 套接字就會等待一定的時間, 然後才被系統銷毀. 
// 這裡所設置的就是套接字在關閉連接後直到被銷毀的滯留時間
//
// 套接字你可以理解為停船的港口, 連接可以理解是停泊在港口的船, 
// 當船離開港口之後, 再過多長時間就會將港口拆掉? 
stall_time: 60

//----- IP 規則設置 -----

// 當有新的連接請求需要建立時, 是否先檢查對方的IP地址
// 這個選項打開時, 也會啟用 DDoS 攻擊防護機制.
enable_ip_rules: yes

// 檢查IP地址是否合法的名單順序
//   deny,allow     : 先檢查黑名單規則, 再檢查白名單規則, 
//                    如果IP地址沒有在任何名單中出現, 則通過. 
//   allow,deny     : 先檢查白名單規則, 再檢查黑名單規則, 
//                    如果IP地址沒有在任何名單中出現, 則通過. 
//   mutual-failure : 要求IP地址必須白名單中, 
//                    並且與此同時不在黑名單中, 才判定為通過. 
// (默認值為 deny,allow 表示先檢查黑名單規則, 再檢查白名單規則)

order: deny,allow
// order: allow,deny
// order: mutual-failture

// IP 規則
//   allow : 允許連接的IP範圍(哪怕它被標記為DDoS的攻擊者)
//   deny  : 拒絕連接的IP範圍
// 程序在處理規則的時候, 優先使用匹配上IP地址的第一個設置

allow: 127.0.0.1
allow: 192.168.0.0/16
// allow: 10.0.0.0/255.0.0.0
// allow: all

// deny: 127.0.0.1


//---- DDoS 攻擊防護設置 ----
// 如果在 ddos_interval 選項指定的時間間隔內, 某個IP地址建立連接的次數
// 超過了 ddos_count 選項指定的次數, 那麼將這個IP視為發起了DDoS攻擊

// 連續嘗試建立連接的間隔時間 (單位為毫秒)
// (默認值為 3000 毫秒, 即3秒)
ddos_interval: 3000

// 連續嘗試建立連接的次數
// (默認值為 5 次)
ddos_count: 5

// 當某個IP地址被判定為發起DDoS攻擊之後, 
// 需要過多長時間(單位為毫秒)才解除這個IP的連接限制
// (默認值為 600000 毫秒, 即10分鐘)
ddos_autoreset: 600000


import: conf/import/packet_conf.txt
